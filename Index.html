<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FuelControl - Controle de Combustível</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2D5BFF;
            --secondary: #6C42F5;
            --accent: #FF6B8B;
            --success: #2CD4A6;
            --warning: #FFC145;
            --danger: #FF5E76;
            --dark: #1A2035;
            --light: #F7F9FC;
            --gray: #8A92A6;
            --card-bg: rgba(255, 255, 255, 0.95);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .app-container {
            width: 100%;
            max-width: 900px;
            background: var(--card-bg);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        
        .app-header h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .app-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        /* Main Content */
        .app-content {
            display: flex;
            flex-wrap: wrap;
        }
        
        /* Left Panel - Forms */
        .left-panel {
            flex: 1;
            min-width: 300px;
            padding: 25px;
            border-right: 1px solid #eee;
        }
        
        /* Right Panel - Results */
        .right-panel {
            flex: 1;
            min-width: 300px;
            padding: 25px;
            background: #f9fafc;
            display: flex;
            flex-direction: column;
        }
        
        .panel-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .input-with-icon input {
            padding-left: 45px;
        }
        
        input {
            width: 100%;
            padding: 14px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(45, 91, 255, 0.1);
        }
        
        input:disabled {
            background-color: #f3f4f6;
            color: #6b7280;
            cursor: not-allowed;
        }
        
        .error {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }
        
        /* Buttons */
        .buttons {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }
        
        button {
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: var(--primary);
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        /* Results */
        .tank-visualization {
            height: 35px;
            background: #e5e7eb;
            border-radius: 18px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }
        
        .tank-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--danger), var(--warning), var(--success));
            border-radius: 18px;
            transition: width 0.8s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .tank-markers {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .result-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .result-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .result-label {
            color: var(--gray);
            font-weight: 500;
        }
        
        .result-value {
            font-weight: 600;
            color: var(--dark);
        }
        
        .litros-display {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-top: 15px;
        }
        
        .litros-display h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .litros-value {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .km-estimate {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
        }
        
        .km-estimate h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .km-value {
            font-size: 2rem;
            font-weight: 700;
        }
        
        /* Info Box */
        .info-box {
            background: #e9f5ff;
            padding: 15px;
            border-radius: 12px;
            margin-top: 25px;
            border-left: 4px solid var(--primary);
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .app-content {
                flex-direction: column;
            }
            
            .left-panel {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
            
            .buttons {
                flex-direction: column;
            }
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1><i class="fas fa-gas-pump"></i> FuelControl</h1>
            <p>Controle completo do consumo do seu veículo</p>
        </header>
        
        <div class="app-content">
            <div class="left-panel">
                <h2 class="panel-title"><i class="fas fa-cog"></i> Configuração</h2>
                
                <div class="form-group">
                    <label for="kmPorLitro"><i class="fas fa-tachometer-alt"></i> Consumo (km/l)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-road"></i>
                        <input type="number" id="kmPorLitro" step="0.1" placeholder="Ex: 12.5">
                    </div>
                    <div class="error" id="errorKmPorLitro">Por favor, insira um valor válido (maior que 0)</div>
                </div>
                
                <div class="form-group">
                    <label for="litrosAbastecidos"><i class="fas fa-oil-can"></i> Litros abastecidos</label>
                    <div class="input-with-icon">
                        <i class="fas fa-gas-pump"></i>
                        <input type="number" id="litrosAbastecidos" step="0.01" placeholder="Ex: 45.50">
                    </div>
                    <div class="error" id="errorLitros">Por favor, insira um valor válido (maior que 0)</div>
                </div>
                
                <div class="form-group">
                    <label for="kmInicial"><i class="fas fa-route"></i> Km do carro com tanque vazio</label>
                    <div class="input-with-icon">
                        <i class="fas fa-map-marker-alt"></i>
                        <input type="number" id="kmInicial" placeholder="Ex: 38500">
                    </div>
                    <div class="error" id="errorKmInicial">Por favor, insira um valor válido (maior que 0)</div>
                </div>
                
                <div class="form-group" id="novoAbastecimentoGroup" style="display: none;">
                    <label for="novosLitros"><i class="fas fa-oil-can"></i> Novo abastecimento (litros)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-gas-pump"></i>
                        <input type="number" id="novosLitros" step="0.01" placeholder="Ex: 20.00">
                    </div>
                    <div class="error" id="errorNovosLitros">Por favor, insira um valor válido (maior que 0)</div>
                </div>
                
                <div class="buttons">
                    <button class="btn-primary" id="btnSalvar" onclick="salvarDados()">
                        <i class="fas fa-save"></i> Salvar
                    </button>
                    <button class="btn-success" id="btnAdicionarLitros" style="display: none;" onclick="adicionarLitros()">
                        <i class="fas fa-plus"></i> Adicionar Litros
                    </button>
                </div>
                
                <div class="info-box">
                    <p><strong>Dica:</strong> Preencha esses dados sempre que abastecer seu veículo para um controle preciso.</p>
                </div>
            </div>
            
            <div class="right-panel">
                <h2 class="panel-title"><i class="fas fa-search"></i> Consulta</h2>
                
                <div class="form-group">
                    <label for="kmAtual"><i class="fas fa-car"></i> KM atual</label>
                    <div class="input-with-icon">
                        <i class="fas fa-map-marker-alt"></i>
                        <input type="number" id="kmAtual" placeholder="Digite a KM atual">
                    </div>
                    <div class="error" id="errorKmAtual">Por favor, insira um valor válido</div>
                </div>
                
                <div class="buttons">
                    <button class="btn-success" onclick="calcularCombustivel()">
                        <i class="fas fa-calculator"></i> Calcular
                    </button>
                    <button class="btn-danger" onclick="limparDados()">
                        <i class="fas fa-trash"></i> Limpar
                    </button>
                </div>
                
                <h2 class="panel-title"><i class="fas fa-chart-line"></i> Resultado</h2>
                
                <div class="tank-visualization">
                    <div class="tank-fill" id="tankFill" style="width: 0%"></div>
                </div>
                <div class="tank-markers">
                    <span>0%</span>
                    <span>50%</span>
                    <span>100%</span>
                </div>
                
                <div class="litros-display" id="litrosDisplay" style="display: none;">
                    <h3>Litros no tanque</h3>
                    <div class="litros-value" id="litrosValue">0 L</div>
                </div>
                
                <div class="result-content" id="resultado">
                    <div style="text-align: center; color: var(--gray); padding: 20px;">
                        <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px;"></i>
                        <p>Configure os dados do seu veículo e consulte o combustível atual</p>
                    </div>
                </div>
                
                <div class="km-estimate" id="kmEstimate" style="display: none;">
                    <h3>Autonomia restante</h3>
                    <div class="km-value" id="kmValue">0 km</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variável para controlar se os campos estão bloqueados
        let camposBloqueados = false;
        
        // Carregar dados do localStorage ao iniciar
        window.onload = function() {
            const kmPorLitro = localStorage.getItem('kmPorLitro');
            const litrosAbastecidos = localStorage.getItem('litrosAbastecidos');
            const kmInicial = localStorage.getItem('kmInicial');
            const camposBloqueadosCache = localStorage.getItem('camposBloqueados');
            
            if (kmPorLitro) {
                document.getElementById('kmPorLitro').value = kmPorLitro;
            }
            
            if (litrosAbastecidos) {
                document.getElementById('litrosAbastecidos').value = litrosAbastecidos;
            }
            
            if (kmInicial) {
                document.getElementById('kmInicial').value = kmInicial;
            }
            
            // Verificar se os campos devem estar bloqueados
            if (camposBloqueadosCache === 'true') {
                bloquearCampos();
                mostrarCampoNovoAbastecimento();
            }
            
            if (kmPorLitro && litrosAbastecidos && kmInicial) {
                document.getElementById('resultado').innerHTML = `
                    <div class="result-item">
                        <span class="result-label">Consumo:</span>
                        <span class="result-value">${kmPorLitro} km/L</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Tanque cheio:</span>
                        <span class="result-value">${litrosAbastecidos} L</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">KM inicial:</span>
                        <span class="result-value">${kmInicial}</span>
                    </div>
                `;
            }
        };
        
        // Função para validar entrada
        function validarEntrada(id, errorId) {
            const input = document.getElementById(id);
            const value = parseFloat(input.value);
            const errorElement = document.getElementById(errorId);
            
            if (isNaN(value) || value <= 0) {
                errorElement.style.display = 'block';
                input.style.borderColor = 'var(--danger)';
                return null;
            } else {
                errorElement.style.display = 'none';
                input.style.borderColor = '#e5e7eb';
                return value;
            }
        }
        
        // Função para bloquear os campos
        function bloquearCampos() {
            document.getElementById('kmPorLitro').disabled = true;
            document.getElementById('litrosAbastecidos').disabled = true;
            document.getElementById('kmInicial').disabled = true;
            camposBloqueados = true;
            localStorage.setItem('camposBloqueados', 'true');
        }
        
        // Função para desbloquear os campos
        function desbloquearCampos() {
            document.getElementById('kmPorLitro').disabled = false;
            document.getElementById('litrosAbastecidos').disabled = false;
            document.getElementById('kmInicial').disabled = false;
            camposBloqueados = false;
            localStorage.setItem('camposBloqueados', 'false');
        }
        
        // Função para mostrar o campo de novo abastecimento
        function mostrarCampoNovoAbastecimento() {
            document.getElementById('novoAbastecimentoGroup').style.display = 'block';
            document.getElementById('btnAdicionarLitros').style.display = 'flex';
            document.getElementById('btnSalvar').style.display = 'none';
        }
        
        // Função para esconder o campo de novo abastecimento
        function esconderCampoNovoAbastecimento() {
            document.getElementById('novoAbastecimentoGroup').style.display = 'none';
            document.getElementById('btnAdicionarLitros').style.display = 'none';
            document.getElementById('btnSalvar').style.display = 'flex';
        }
        
        // Função para salvar dados
        function salvarDados() {
            const kmPorLitro = validarEntrada('kmPorLitro', 'errorKmPorLitro');
            const litrosAbastecidos = validarEntrada('litrosAbastecidos', 'errorLitros');
            const kmInicial = validarEntrada('kmInicial', 'errorKmInicial');
            
            if (kmPorLitro === null || litrosAbastecidos === null || kmInicial === null) {
                return;
            }
            
            // Salvar dados no localStorage
            localStorage.setItem('kmPorLitro', kmPorLitro);
            localStorage.setItem('litrosAbastecidos', litrosAbastecidos);
            localStorage.setItem('kmInicial', kmInicial);
            
            // Bloquear os campos após salvar
            bloquearCampos();
            
            // Mostrar o campo para novo abastecimento
            mostrarCampoNovoAbastecimento();
            
            document.getElementById('resultado').innerHTML = `
                <div class="result-item">
                    <span class="result-label">Consumo:</span>
                    <span class="result-value">${kmPorLitro} km/L</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Tanque cheio:</span>
                    <span class="result-value">${litrosAbastecidos} L</span>
                </div>
                <div class="result-item">
                    <span class="result-label">KM inicial:</span>
                    <span class="result-value">${kmInicial}</span>
                </div>
            `;
                
            // Limpar campo de KM atual
            document.getElementById('kmAtual').value = '';
            
            // Esconder estimativa de KM e display de litros
            document.getElementById('kmEstimate').style.display = 'none';
            document.getElementById('litrosDisplay').style.display = 'none';
            
            // Resetar visualização do tanque
            document.getElementById('tankFill').style.width = '0%';
            document.getElementById('tankFill').textContent = '';
        }
        
        // Função para adicionar litros ao tanque
        function adicionarLitros() {
            const novosLitros = validarEntrada('novosLitros', 'errorNovosLitros');
            if (novosLitros === null) return;
            
            // Obter os litros atuais do localStorage
            const litrosAtuais = parseFloat(localStorage.getItem('litrosAbastecidos'));
            
            // Somar os novos litros com os litros atuais
            const totalLitros = litrosAtuais + novosLitros;
            
            // Atualizar o valor no localStorage
            localStorage.setItem('litrosAbastecidos', totalLitros);
            
            // Atualizar o campo "Litros abastecidos" na interface
            document.getElementById('litrosAbastecidos').value = totalLitros;
            
            // Limpar o campo de novos litros
            document.getElementById('novosLitros').value = '';
            
            // Atualizar a exibição na interface
            if (document.querySelector('#resultado .result-item:nth-child(2) .result-value')) {
                document.querySelector('#resultado .result-item:nth-child(2) .result-value').textContent = totalLitros + ' L';
            }
            
            // Mostrar mensagem de sucesso
            alert(`Adicionados ${novosLitros} litros. Total no tanque: ${totalLitros} litros.`);
        }
        
        // Função para calcular o combustível
        function calcularCombustivel() {
            const kmPorLitro = localStorage.getItem('kmPorLitro');
            const litrosAbastecidos = localStorage.getItem('litrosAbastecidos');
            const kmInicial = localStorage.getItem('kmInicial');
            
            if (!kmPorLitro || !litrosAbastecidos || !kmInicial) {
                alert('Por favor, configure os dados do abastecimento primeiro!');
                return;
            }
            
            const kmAtualValue = validarEntrada('kmAtual', 'errorKmAtual');
            if (kmAtualValue === null) return;
            
            const kmAtual = parseInt(kmAtualValue);
            const kmInicialNum = parseInt(kmInicial);
            
            if (kmAtual < kmInicialNum) {
                document.getElementById('errorKmAtual').textContent = 'A KM atual não pode ser menor que a KM do abastecimento!';
                document.getElementById('errorKmAtual').style.display = 'block';
                document.getElementById('kmAtual').style.borderColor = 'var(--danger)';
                return;
            }
            
            // Calcular a diferença de KM
            const kmPercorridos = kmAtual - kmInicialNum;
            
            // Calcular litros consumidos
            const litrosConsumidos = kmPercorridos / parseFloat(kmPorLitro);
            
            // Calcular litros restantes
            const litrosRestantes = parseFloat(litrosAbastecidos) - litrosConsumidos;
            
            // Calcular porcentagem do tanque
            const porcentagemTanque = (litrosRestantes / parseFloat(litrosAbastecidos)) * 100;
            
            // Calcular quantos km ainda pode andar
            const kmRestantes = litrosRestantes * parseFloat(kmPorLitro);
            
            // Atualizar visualização do tanque
            const tankFill = document.getElementById('tankFill');
            const porcentagemVisual = Math.max(0, Math.min(100, porcentagemTanque));
            tankFill.style.width = porcentagemVisual + '%';
            tankFill.textContent = porcentagemVisual.toFixed(1) + '%';
            
            // Mostrar display de litros
            document.getElementById('litrosDisplay').style.display = 'block';
            document.getElementById('litrosValue').textContent = litrosRestantes.toFixed(1) + ' L';
            
            // Mostrar estimativa de KM
            document.getElementById('kmEstimate').style.display = 'block';
            document.getElementById('kmValue').textContent = kmRestantes.toFixed(0) + ' km';
            
            if (litrosRestantes <= 0) {
                document.getElementById('resultado').innerHTML = 
                    `<div style="text-align: center; color: var(--danger); padding: 10px;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                        <h3>Tanque vazio!</h3>
                        <p>Você percorreu ${kmPercorridos} km desde o abastecimento</p>
                        <p>Consumiu ${litrosConsumidos.toFixed(2)} litros</p>
                    </div>`;
            } else {
                document.getElementById('resultado').innerHTML = 
                    `<div class="result-item">
                        <span class="result-label">KM percorridos:</span>
                        <span class="result-value">${kmPercorridos} km</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Litros consumidos:</span>
                        <span class="result-value">${litrosConsumidos.toFixed(2)} L</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Consumo médio:</span>
                        <span class="result-value">${kmPorLitro} km/L</span>
                    </div>`;
            }
        }
        
        // Função para limpar todos os dados
        function limparDados() {
            if (confirm('Tem certeza que deseja limpar todos os dados?')) {
                // Limpar localStorage
                localStorage.removeItem('kmPorLitro');
                localStorage.removeItem('litrosAbastecidos');
                localStorage.removeItem('kmInicial');
                localStorage.removeItem('camposBloqueados');
                
                // Desbloquear campos
                desbloquearCampos();
                
                // Esconder campo de novo abastecimento
                esconderCampoNovoAbastecimento();
                
                // Limpar campos
                document.getElementById('kmPorLitro').value = '';
                document.getElementById('litrosAbastecidos').value = '';
                document.getElementById('kmInicial').value = '';
                document.getElementById('kmAtual').value = '';
                document.getElementById('novosLitros').value = '';
                
                // Resetar visualização do tanque
                document.getElementById('tankFill').style.width = '0%';
                document.getElementById('tankFill').textContent = '';
                
                // Esconder estimativa de KM e display de litros
                document.getElementById('kmEstimate').style.display = 'none';
                document.getElementById('litrosDisplay').style.display = 'none';
                
                // Esconder mensagens de erro
                document.querySelectorAll('.error').forEach(error => {
                    error.style.display = 'none';
                });
                
                // Resetar bordas dos inputs
                document.querySelectorAll('input').forEach(input => {
                    input.style.borderColor = '#e5e7eb';
                });
                
                document.getElementById('resultado').innerHTML = 
                    `<div style="text-align: center; color: var(--gray); padding: 20px;">
                        <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px;"></i>
                        <p>Configure os dados do seu veículo e consulte o combustível atual</p>
                    </div>`;
            }
        }
    </script>
</body>
</html>
